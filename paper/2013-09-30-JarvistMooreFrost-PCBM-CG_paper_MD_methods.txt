
## Methods

## Coarse grain fullerene adduct molecular dynamics

Here we extend the Girifalco \cite{Girifalco_PRB_2000} coarse grain buckminsterfullerene (C$_60$) forcefield. 
The general principle in the creation of this simple forcefield is in the smearing out of the effective Lennards-Jones interactions of 60 graphitic-like carbons over the surface of a sphere the experimental size of a C60 fullerene. 
We believe this to be directly transferable to the interaction of the fullerene cages in functionalised adducts.

Our intent is to simulate the various PCBM adducts with a simple two-bead model for the fullerene cage and the side-chain, modelled entirely with Lennard-Jones interactions for computational efficiency. 
This model for the side-chain of a single spherical super-atom is likely to be better for more symmetric sidechains than PCBM such as indene-functionalised fullerenes.

We created an atomistic model for mono-PCBM based on the OPLS \cite{OPLS} empirical force-field, with the reference geometry from a gas-phase quantum chemistry calculation (b3lyp/6-31g*), and the fullerene cage simulated as arbitrarily stiff. 
This we used to do molecular dynamics on a small ensemble (TODO: MD params atomistic) to generate radial distribution functions which we used to fit the coarse-grain molecular dynamics model.

In our coarse-grain model, we choose the interaction energy of the sidechain bead to be the same as the Girifalco parameter for the fullerene site, scaled by the mass of the sidechain (190 Da versus 720.6 for C_{60}). 

We then compared coarse-grain radial distribution functions to the atomistic model, varying the effective bond length of the fullerene-sidechain connection, and the effective van-de-Waals radius of the sidechain.

$ V_{LJ} = 4 \epsilon (\left ( \frac{\sigma}{r} \right )^{12} - \left(\frac{\sigma}{r}\right )^{6}) $

With $\epsilon_{C60}=26.823$ kJ/mol, $\sigma_{C60}=0.895$ nm; $\epsilon_{PBM}=10.0$ kJ/mol, $\sigma_{PBM}=0.704$ nm; the C60-PBM bond being $r=0.64$ nm. 

Having fitted a coarse grain model for mono PCBM, we then extended this to the various fullerene isomer adducts by added extra mono-PCBM sidechain sites at the positions of the adducts. 
The parameters for the irreducible set of bis and tris isomers were generated by computationally expedient direct enumeration of all possible configurations. Reduction of the set was made with a simple canonical representation (TODO: angles in table for the Supp Info?).

## Transport simulations on molecular dynamic assemblies

We approximate the electron transfer integral between fullerenes with an isotropic approximation where $J \propto exp (-\alpha d)$ where $d$ is inter-fullerene cage distance and $\alpha$ is $0.5 \AA^{-1}$. 

Our choice of an isotropic transfer integral is due to the simplicity of extracting this single dimension $d$ from the coarse-grain molecular-dynamics simulation, without needing to consider the attitude of individual molecules. Our previous work\cite{kwaitowski_fullerene} shows that the variation in transfer integrals between unfunctionalised fullerenes varies by [TODO: check this] a factor of two, a relatively small effect compared to variations due to packing.

The cyclo-addition of fullerenes to form the functionalised adducts we study in this work profoundly alters the electronic structure of the fullerene (each addition consumes a (pi orbital) conjugated [TODO: not right wording] electron in forming the sidechain bond). 
Even different isomers have explicitly different molecular orbital energy levels \cite{Jarvist_AM_2010}. 

Here we use an isotopic transfer integral to approximate the full treatment which would require electronic structure calculations of a wide range of different fullerene adduct isomers. 
We postulate that the variation in real-world mobilities can be explained through the variation of fullerene-fullerene packing caused by the various sidechains, and by the consideration of the varying isomer energy levels \cite{Jarvist_AM_2010} as a Gaussian distribution imposed on the site-energies in the semi-classical Marcus equation.


Simulations of time of flight transients were carried out using the ToFeT package \cite{ToFeT}.

## References

(Girifalco_PRB_2000) PRB,LA Girifalco, Volume 62, Number 19, 15th Nov 2000

## Notes / ToDo:
NB: Did Flo ever check the Js for Bis/Tris as suggested? I may have some calcs sitting gathering dust... JMF
